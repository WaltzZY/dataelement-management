<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inspur.dsp.direct.dao.RevisionCommentMapper">

    <!-- 根据数据元ID查询修订意见 -->
    <select id="selectbydataid" resultType="com.inspur.dsp.direct.entity.RevisionComment">
        SELECT 
            id,
            base_dataelement_dataid AS baseDataelementDataid,
            comment,
            revision_initiator_account AS revisionInitiatorAccount,
            revision_initiator_name AS revisionInitiatorName,
            revision_createdate AS revisionCreatedate,
            revision_initiator_tel AS revisionInitiatorTel,
            create_date AS createDate,
            create_account AS createAccount,
            last_modify_date AS lastModifyDate,
            last_modify_account AS lastModifyAccount
        FROM revision_comment
        WHERE base_dataelement_dataid = #{dataElementId}
        ORDER BY create_date DESC
        LIMIT 1
    </select>

    <!-- 根据数据元ID查询所有修订意见 -->
    <select id="selectAllByDataId" resultType="com.inspur.dsp.direct.entity.RevisionComment">
        SELECT 
            id,
            base_dataelement_dataid AS baseDataelementDataid,
            comment,
            revision_initiator_account AS revisionInitiatorAccount,
            revision_initiator_name AS revisionInitiatorName,
            revision_createdate AS revisionCreatedate,
            revision_initiator_tel AS revisionInitiatorTel,
            create_date AS createDate,
            create_account AS createAccount,
            last_modify_date AS lastModifyDate,
            last_modify_account AS lastModifyAccount
        FROM revision_comment
        WHERE base_dataelement_dataid = #{dataElementId}
        ORDER BY create_date DESC
    </select>
    
    <!-- 批量插入修订意见 -->
    <insert id="batchInsert">
        INSERT INTO revision_comment (
            id,
            base_dataelement_dataid,
            comment,
            revision_initiator_account,
            revision_initiator_name,
            revision_createdate,
            revision_initiator_tel,
            create_date,
            create_account,
            last_modify_date,
            last_modify_account
        ) VALUES
        <foreach collection="revisionComments" item="item" separator=",">
        (
            #{item.id},
            #{item.baseDataelementDataid},
            #{item.comment},
            #{item.revisionInitiatorAccount},
            #{item.revisionInitiatorName},
            #{item.revisionCreatedate},
            #{item.revisionInitiatorTel},
            #{item.createDate},
            #{item.createAccount},
            #{item.lastModifyDate},
            #{item.lastModifyAccount}
        )
        </foreach>
    </insert>

</mapper>
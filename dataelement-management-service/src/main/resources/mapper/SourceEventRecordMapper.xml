<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inspur.dsp.direct.dao.SourceEventRecordMapper">
    <resultMap id="BaseResultMap" type="com.inspur.dsp.direct.dbentity.SourceEventRecord">
        <!--@mbg.generated-->
        <!--@Table source_event_record-->
        <id column="record_id" jdbcType="VARCHAR" property="recordId"/>
        <result column="data_element_id" jdbcType="VARCHAR" property="dataElementId"/>
        <result column="data_element_name" jdbcType="VARCHAR" property="dataElementName"/>
        <result column="source_type" jdbcType="VARCHAR" property="sourceType"/>
        <result column="source_date" jdbcType="TIMESTAMP" property="sourceDate"/>
        <result column="operator_account" jdbcType="VARCHAR" property="operatorAccount"/>
        <result column="contact_phone" jdbcType="VARCHAR" property="contactPhone"/>
        <result column="contact_name" jdbcType="VARCHAR" property="contactName"/>
        <result column="source_unit_code" jdbcType="VARCHAR" property="sourceUnitCode"/>
        <result column="source_unit_name" jdbcType="VARCHAR" property="sourceUnitName"/>
        <result column="send_unit_code" jdbcType="VARCHAR" property="sendUnitCode"/>
        <result column="send_unit_name" jdbcType="VARCHAR" property="sendUnitName"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--@mbg.generated-->
        record_id, data_element_id, data_element_name, source_type, source_date, operator_account,
        contact_phone, contact_name, source_unit_code, source_unit_name, send_unit_code,
        send_unit_name
    </sql>

    <!--auto generated by MybatisCodeHelper on 2025-09-17-->
    <select id="selectFirstByDataElementIdOrderBySourceDateDesc" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from source_event_record
        where data_element_id=#{dataElementId,jdbcType=VARCHAR} order by source_date desc limit 1
    </select>

    <select id="getProcessMessageForRecord" resultMap="BaseResultMap">
        SELECT *
        FROM source_event_record ser
        WHERE ser.data_element_id = #{dataid}
        ORDER BY ser.source_date DESC
        LIMIT 1
    </select>


</mapper>